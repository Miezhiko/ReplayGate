<!DOCTYPE html>
<html lang="en">

<style>
  #drag-file {
    background-color: lightgray;
    color: darkgray;
    text-align: center;
    width: 100%;
    height: 500px;
  }
</style>

<head>
  <meta charset="utf-8">
  <title>Replay Gate</title>
</head>
<body style="margin:0;padding:0;-webkit-app-region: drag;">
  <h1 style="margin:0;padding:0;text-align:center;">
    Replay Gate
  </h1>
  <div id="drag-file">
    <h2>Drag replay files here</h2>
  </div>
  <canvas id="apmChart"></canvas>
  <div id="results">
  </div>
</body>

<script>
  const { ipcRenderer } = require('electron');
  (function () {
    var Chart = require('chart.js');
    var holder = document.getElementById('drag-file');
    var resf = document.getElementById('results');
    var ctx = document.getElementById('apmChart').getContext('2d');
    ipcRenderer.on('replay-go', (event, res) => {
      holder.style.display = "none";

      resf.innerHTML = JSON.stringify(res.result, null, '  ');

      var chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: res.labels,
          datasets: res.data
        },
        options: {
          scales: {
            xAxes: [{
              type: 'linear'
            }]
          },
          responsive: true
        }
      });
    });
    holder.ondragover = () => {
      return false;
    };
    holder.ondragleave = () => {
      return false;
    };
    holder.ondragend = () => {
      return false;
    };
    holder.ondrop = (e) => {
      e.preventDefault();
      for (let f of e.dataTransfer.files) {
        ipcRenderer.send('replay-go', f.path);
      }
      return false;
    };
  })();
</script>

</html>
